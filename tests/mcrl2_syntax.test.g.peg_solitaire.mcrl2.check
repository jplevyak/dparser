7997 states 4664 scans 4664 shifts 5301 reductions 0 compares 0 ambiguities
((( sort (( Piece  = ( struct (( empty )(( | ( pin ))( | ( unused ))))) ; )( Row  = ( struct (( row ( ( (( Piece )(( , ( Piece ))( , ( Piece ))( , ( Piece ))( , ( Piece ))( , ( Piece ))( , ( Piece )))) ) )))) ; )( Board  = ( struct (( col ( ( (( Row )(( , ( Row ))( , ( Row ))( , ( Row ))( , ( Row ))( , ( Row ))( , ( Row )))) ) )))) ; )))( map (((( getPiece ) : ((( Pos  #  Pos ) #  Board ) ->  Piece )) ; )((( setPiece ) : (((( Pos  #  Pos ) #  Piece ) #  Board ) ->  Board )) ; )))(( var ((((( x ) :  Pos )) ; )(((( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) :  Row )) ; )(((( pc ) :  Piece )) ; ))) eqn ((( getPiece  ( ( x (( ,  1 )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( getPiece  ( ( x ( ,  r1 )) ) ) ; )(( getPiece  ( ( x (( ,  2 )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( getPiece  ( ( x ( ,  r2 )) ) ) ; )(( getPiece  ( ( x (( ,  3 )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( getPiece  ( ( x ( ,  r3 )) ) ) ; )(( getPiece  ( ( x (( ,  4 )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( getPiece  ( ( x ( ,  r4 )) ) ) ; )(( getPiece  ( ( x (( ,  5 )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( getPiece  ( ( x ( ,  r5 )) ) ) ; )(( getPiece  ( ( x (( ,  6 )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( getPiece  ( ( x ( ,  r6 )) ) ) ; )(( getPiece  ( ( x (( ,  7 )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( getPiece  ( ( x ( ,  r7 )) ) ) ; )(( setPiece  ( ( x (( ,  1 )( ,  pc )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( col  ( (( setPiece  ( ( x (( ,  pc )( ,  r1 ))) ) )(( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) ) ; )(( setPiece  ( ( x (( ,  2 )( ,  pc )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( col  ( ( r1 (( , ( setPiece  ( ( x (( ,  pc )( ,  r2 ))) ) ))( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) ) ; )(( setPiece  ( ( x (( ,  3 )( ,  pc )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( col  ( ( r1 (( ,  r2 )( , ( setPiece  ( ( x (( ,  pc )( ,  r3 ))) ) ))( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) ) ; )(( setPiece  ( ( x (( ,  4 )( ,  pc )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( col  ( ( r1 (( ,  r2 )( ,  r3 )( , ( setPiece  ( ( x (( ,  pc )( ,  r4 ))) ) ))( ,  r5 )( ,  r6 )( ,  r7 ))) ) ) ; )(( setPiece  ( ( x (( ,  5 )( ,  pc )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( , ( setPiece  ( ( x (( ,  pc )( ,  r5 ))) ) ))( ,  r6 )( ,  r7 ))) ) ) ; )(( setPiece  ( ( x (( ,  6 )( ,  pc )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( , ( setPiece  ( ( x (( ,  pc )( ,  r6 ))) ) ))( ,  r7 ))) ) ) ; )(( setPiece  ( ( x (( ,  7 )( ,  pc )( , ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( ,  r7 ))) ) )))) ) ) = ( col  ( ( r1 (( ,  r2 )( ,  r3 )( ,  r4 )( ,  r5 )( ,  r6 )( , ( setPiece  ( ( x (( ,  pc )( ,  r7 ))) ) )))) ) ) ; )))( map (((( getPiece ) : (( Pos  #  Row ) ->  Piece )) ; )((( setPiece ) : ((( Pos  #  Piece ) #  Row ) ->  Row )) ; )))(( var ((((( p ) :  Pos )) ; )(((( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) :  Piece )) ; )(((( pc ) :  Piece )) ; ))) eqn ((( setPiece  ( ( 1 (( ,  pc )( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) )))) ) ) = ( row  ( ( pc (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ) ; )(( setPiece  ( ( 2 (( ,  pc )( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) )))) ) ) = ( row  ( ( p1 (( ,  pc )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ) ; )(( setPiece  ( ( 3 (( ,  pc )( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) )))) ) ) = ( row  ( ( p1 (( ,  p2 )( ,  pc )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ) ; )(( setPiece  ( ( 4 (( ,  pc )( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) )))) ) ) = ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  pc )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ) ; )(( setPiece  ( ( 5 (( ,  pc )( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) )))) ) ) = ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  pc )( ,  p6 )( ,  p7 ))) ) ) ; )(( setPiece  ( ( 6 (( ,  pc )( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) )))) ) ) = ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  pc )( ,  p7 ))) ) ) ; )(( setPiece  ( ( 7 (( ,  pc )( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) )))) ) ) = ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  pc ))) ) ) ; )(( getPiece  ( ( 1 ( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ))) ) ) =  p1  ; )(( getPiece  ( ( 2 ( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ))) ) ) =  p2  ; )(( getPiece  ( ( 3 ( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ))) ) ) =  p3  ; )(( getPiece  ( ( 4 ( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ))) ) ) =  p4  ; )(( getPiece  ( ( 5 ( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ))) ) ) =  p5  ; )(( getPiece  ( ( 6 ( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ))) ) ) =  p6  ; )(( getPiece  ( ( 7 ( , ( row  ( ( p1 (( ,  p2 )( ,  p3 )( ,  p4 )( ,  p5 )( ,  p6 )( ,  p7 ))) ) ))) ) ) =  p7  ; )))( map ((( initialBoard (( ,  finalBoard )( ,  emptyBoard ))) :  Board ) ; ))( eqn (( initialBoard  = ( col  ( (( row  ( ( unused (( ,  unused )( ,  pin )( ,  pin )( ,  pin )( ,  unused )( ,  unused ))) ) )(( , ( row  ( ( unused (( ,  unused )( ,  pin )( ,  pin )( ,  pin )( ,  unused )( ,  unused ))) ) ))( , ( row  ( ( pin (( ,  pin )( ,  pin )( ,  pin )( ,  pin )( ,  pin )( ,  pin ))) ) ))( , ( row  ( ( pin (( ,  pin )( ,  pin )( ,  empty )( ,  pin )( ,  pin )( ,  pin ))) ) ))( , ( row  ( ( pin (( ,  pin )( ,  pin )( ,  pin )( ,  pin )( ,  pin )( ,  pin ))) ) ))( , ( row  ( ( unused (( ,  unused )( ,  pin )( ,  pin )( ,  pin )( ,  unused )( ,  unused ))) ) ))( , ( row  ( ( unused (( ,  unused )( ,  pin )( ,  pin )( ,  pin )( ,  unused )( ,  unused ))) ) )))) ) ) ; )( finalBoard  = ( col  ( (( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) )(( , ( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) ))( , ( row  ( ( empty (( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty ))) ) ))( , ( row  ( ( empty (( ,  empty )( ,  empty )( ,  pin )( ,  empty )( ,  empty )( ,  empty ))) ) ))( , ( row  ( ( empty (( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty ))) ) ))( , ( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) ))( , ( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) )))) ) ) ; )( emptyBoard  = ( col  ( (( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) )(( , ( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) ))( , ( row  ( ( empty (( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty ))) ) ))( , ( row  ( ( empty (( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty ))) ) ))( , ( row  ( ( empty (( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty )( ,  empty ))) ) ))( , ( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) ))( , ( row  ( ( unused (( ,  unused )( ,  empty )( ,  empty )( ,  empty )( ,  unused )( ,  unused ))) ) )))) ) ) ; )))( map (((( rightMovable (( ,  leftMovable )( ,  downMovable )( ,  upMovable ))) : ((( Pos  #  Pos ) #  Board ) ->  Bool )) ; )((( moveRight (( ,  moveLeft )( ,  moveDown )( ,  moveUp ))) : ((( Pos  #  Pos ) #  Board ) ->  Board )) ; )))(( var ((((( x ( ,  y )) :  Pos )) ; )(((( b ) :  Board )) ; ))) eqn ((( rightMovable  ( ( x (( ,  y )( ,  b ))) ) ) = ((( getPiece  ( ( x (( ,  y )( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( (( x  +  1 )(( ,  y )( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( (( x  +  2 )(( ,  y )( ,  b ))) ) ) ==  empty ) && ( x  <  6 )))) ; )(( moveRight  ( ( x (( ,  y )( ,  b ))) ) ) = ( setPiece  ( ( x (( ,  y )( ,  empty )( , ( setPiece  ( (( x  +  1 )(( ,  y )( ,  empty )( , ( setPiece  ( (( x  +  2 )(( ,  y )( ,  pin )( ,  b ))) ) )))) ) )))) ) ) ; )(( leftMovable  ( ( x (( ,  y )( ,  b ))) ) ) = ((( getPiece  ( ( x (( ,  y )( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( (( Int2Pos  ( (( x  -  1 )) ) )(( ,  y )( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( (( Int2Pos  ( (( x  -  2 )) ) )(( ,  y )( ,  b ))) ) ) ==  empty ) && ( x  >  2 )))) ; )(( moveLeft  ( ( x (( ,  y )( ,  b ))) ) ) = ( setPiece  ( ( x (( ,  y )( ,  empty )( , ( setPiece  ( (( Int2Pos  ( (( x  -  1 )) ) )(( ,  y )( ,  empty )( , ( setPiece  ( (( Int2Pos  ( (( x  -  2 )) ) )(( ,  y )( ,  pin )( ,  b ))) ) )))) ) )))) ) ) ; )(( downMovable  ( ( x (( ,  y )( ,  b ))) ) ) = ((( getPiece  ( ( x (( ,  y )( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( ( x (( , ( Int2Pos  ( (( y  -  1 )) ) ))( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( ( x (( , ( Int2Pos  ( (( y  -  2 )) ) ))( ,  b ))) ) ) ==  empty ) && ( y  >  2 )))) ; )(( moveDown  ( ( x (( ,  y )( ,  b ))) ) ) = ( setPiece  ( ( x (( ,  y )( ,  empty )( , ( setPiece  ( ( x (( , ( Int2Pos  ( (( y  -  1 )) ) ))( ,  empty )( , ( setPiece  ( ( x (( , ( Int2Pos  ( (( y  -  2 )) ) ))( ,  pin )( ,  b ))) ) )))) ) )))) ) ) ; )(( upMovable  ( ( x (( ,  y )( ,  b ))) ) ) = ((( getPiece  ( ( x (( ,  y )( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( ( x (( , ( y  +  1 ))( ,  b ))) ) ) ==  pin ) && ((( getPiece  ( ( x (( , ( y  +  2 ))( ,  b ))) ) ) ==  empty ) && ( y  <  6 )))) ; )(( moveUp  ( ( x (( ,  y )( ,  b ))) ) ) = ( setPiece  ( ( x (( ,  y )( ,  empty )( , ( setPiece  ( ( x (( , ( y  +  1 ))( ,  empty )( , ( setPiece  ( ( x (( , ( y  +  2 ))( ,  pin )( ,  b ))) ) )))) ) )))) ) ) ; )))( act ((( moveright (( ,  moveleft )( ,  moveup )( ,  movedown )))( : (( Pos  #  Pos ) #  Piece )) ; )(( ready ) ; )))( proc ( X ( ( ((( b ) :  Board )) ) ) = (((((((( ( ( b  ==  finalBoard ) ) ) -> )(( ready ) . ( X ( ( ( emptyBoard ) ) )))) + (( sum ((( x ( ,  y )) :  Pos )) . )((( ( (( x  <=  7 ) && (( y  <=  7 ) && ( rightMovable  ( ( x (( ,  y )( ,  b ))) ) ))) ) ) -> )(( moveright ( ( ( x (( ,  y )( , ( getPiece  ( ( x (( ,  y )( ,  b ))) ) )))) ) )) . ( X ( ( (( moveRight  ( ( x (( ,  y )( ,  b ))) ) )) ) )))))) + (( sum ((( x ( ,  y )) :  Pos )) . )((( ( (( x  <=  7 ) && (( y  <=  7 ) && ( leftMovable  ( ( x (( ,  y )( ,  b ))) ) ))) ) ) -> )(( moveleft ( ( ( x (( ,  y )( , ( getPiece  ( ( x (( ,  y )( ,  b ))) ) )))) ) )) . ( X ( ( (( moveLeft  ( ( x (( ,  y )( ,  b ))) ) )) ) )))))) + (( sum ((( x ( ,  y )) :  Pos )) . )((( ( (( x  <=  7 ) && (( y  <=  7 ) && ( downMovable  ( ( x (( ,  y )( ,  b ))) ) ))) ) ) -> )(( movedown ( ( ( x (( ,  y )( , ( getPiece  ( ( x (( ,  y )( ,  b ))) ) )))) ) )) . ( X ( ( (( moveDown  ( ( x (( ,  y )( ,  b ))) ) )) ) )))))) + (( sum ((( x ( ,  y )) :  Pos )) . )((( ( (( x  <=  7 ) && (( y  <=  7 ) && ( upMovable  ( ( x (( ,  y )( ,  b ))) ) ))) ) ) -> )(( moveup ( ( ( x (( ,  y )( , ( getPiece  ( ( x (( ,  y )( ,  b ))) ) )))) ) )) . ( X ( ( (( moveUp  ( ( x (( ,  y )( ,  b ))) ) )) ) )))))) +  delta ) ; )))( init ( X ( ( ( initialBoard ) ) )) ; ))
